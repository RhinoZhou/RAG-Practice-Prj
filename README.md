# RAGç³»ç»Ÿæ–‡æœ¬åˆ†å—å®è·µé¡¹ç›®

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªå…¨é¢çš„RAGï¼ˆRetrieval-Augmented Generationï¼‰ç³»ç»Ÿæ–‡æœ¬åˆ†å—æŠ€æœ¯å®è·µé›†åˆï¼ŒåŒ…å«äº†ä»åŸºç¡€åˆ†å—ç®—æ³•åˆ°é«˜çº§ç­–ç•¥ç¼–æ’çš„å®Œæ•´è§£å†³æ–¹æ¡ˆã€‚

## ğŸ“ ç›®å½•ç»“æ„

### æ ¸å¿ƒå®éªŒè„šæœ¬ï¼ˆæ•°å­—å¼€å¤´ï¼‰

#### åŸºç¡€å®éªŒä¸åˆ†æï¼ˆ01-06ï¼‰
- **01-u_curve_chunksize_f1_latency_experiment.py** - åˆ†å—ç²’åº¦-å‡†ç¡®ç‡-å»¶è¿Ÿå€’Uæ›²çº¿å®éªŒ
- **02_overlap_coverage_vs_index_scale_analysis.py** - åˆ†å—é‡å -è¦†ç›–ç‡-ç´¢å¼•è§„æ¨¡åˆ†æ
- **03-min_evalset_builder_multiscenario.py** - å¤šåœºæ™¯æœ€å°éªŒè¯é›†ç”Ÿæˆå™¨
- **04-token_size_band_explorer_f1_ndcg_coverage.py** - Tokenå°ºå¯¸åŒºé—´æ¢ç´¢ä¸ä»»åŠ¡é€‚é…åˆ†æ
- **05-_hierarchical_chunking_overlap_dynamic_boundary_demo.py** - å±‚æ¬¡åŒ–åˆ†å—ä¸ä¸Šä¸‹æ–‡çªç ´æ¼”ç¤º
- **06-_answer_span_match_vs_chunk_granularity.py** - ç­”æ¡ˆè·¨åº¦åŒ¹é…åº¦ä¸å—ç²’åº¦å…³ç³»è¯„ä¼°

#### åˆ†å—ç®—æ³•å®ç°ï¼ˆ07-15ï¼‰
- **07-_token_fixed_overlap_chunker.py** - å›ºå®šé‡å Tokenåˆ†å—å™¨
- **08-recursive_paragraph_first_splitter.py** - é€’å½’æ®µè½ä¼˜å…ˆåˆ†å‰²å™¨
- **09-hierarchical_chunking_overlap_dynamic_boundary_demo.py** - åŸºäºMarkdown/PDFçš„ç»“æ„åŒ–åˆ†å—æ¼”ç¤º
- **10-pdf_layout_paragraph_table_chunker.py** - PDFç‰ˆé¢ç‰¹å¾è¾…åŠ©åˆ†å—å™¨
- **11-dialog_turn_detector.py** - å¯¹è¯è½®æ¬¡æ£€æµ‹å™¨
- **12-markdown_structure_aware_chunker.py** - Markdownç»“æ„æ„ŸçŸ¥åˆ†å—å™¨
- **13-topic_cluster_boundary_chunker.py** - ä¸»é¢˜èšç±»é©±åŠ¨è¾¹ç•Œåˆ†å—å™¨
- **14-coref_srl_boundary_guard.py** - æŒ‡ä»£é“¾ä¸SRLå®ˆæŠ¤è¾¹ç•Œåˆ†å—å™¨
- **15-ner_density_adaptive_chunking.py** - å®ä½“å¯†åº¦è‡ªé€‚åº”åˆ†å—å™¨

#### é«˜çº§æŠ€æœ¯ä¸ä¼˜åŒ–ï¼ˆ16-26ï¼‰
- **16-embed_layout_fusion_clustering_segments.py** - åµŒå…¥ä¸èšç±»é©±åŠ¨çš„è¾¹ç•Œå‘ç°æ¼”ç¤º
- **17-tiktoken_length_distribution_report.py** - Tiktokenç²¾å‡†è®¡æ•°ä¸åˆ†å¸ƒæŠ¥å‘Šç”Ÿæˆå™¨
- **18-overlap_coverage_redundancy_evaluator.py** - é‡å ç‡ä¸ä¿¡æ¯è¦†ç›–è¯„ä¼°å·¥å…·
- **19-resource_adaptive_chunking_policy_simulator.py** - èµ„æºè‡ªé€‚åº”åˆ†å—ç­–ç•¥æ¨¡æ‹Ÿå™¨
- **20-chunk_metadata_schema_generator.py** - åˆ†å—å…ƒæ•°æ®æ¨¡æ¿ç”Ÿæˆå™¨
- **21-pyramid_index_with_provenance.py** - åˆ†å—æº¯æºä¸å±‚çº§ç´¢å¼•å®ç°
- **22-hybrid_chunking_strategy_orchestrator.py** - æ··åˆåˆ†å—ç­–ç•¥ç¼–æ’å™¨
- **24-multistage_index_two_pass_retrieval.py** - å¤šçº§ç´¢å¼•ä¸äºŒæ¬¡æ£€ç´¢æ¼”ç¤º
- **25-strategy_params_to_metrics_mapper.py** - åˆ†å—ç­–ç•¥å‚æ•°åˆ°æŒ‡æ ‡æ˜ å°„å™¨
- **26-massive_pipeline_simulator_checkpointing.py** - æµ·é‡æ–‡æ¡£å¤„ç†æµæ°´çº¿æ¨¡æ‹Ÿå™¨ï¼ˆå¸¦æ–­ç‚¹ç»­ä¼ ï¼‰

### è¾…åŠ©å·¥å…·ä¸åˆ†æè„šæœ¬
- **analyze_*.py** - å„ç§åˆ†æå·¥å…·è„šæœ¬
- **check_*.py** - æ£€æŸ¥å’ŒéªŒè¯å·¥å…·
- **visualize_*.py** - å¯è§†åŒ–å·¥å…·
- **checkpoint_recovery_demo.py** - æ£€æŸ¥ç‚¹æ¢å¤æ¼”ç¤º

### æ•°æ®ç›®å½•
- **ğŸ“ data/** - æµ‹è¯•æ•°æ®æ–‡ä»¶
  - `billionaires_page-1-5.pdf` - PDFæµ‹è¯•æ–‡æ¡£
  - `medical_ai_dialog.txt` - åŒ»ç–—AIå¯¹è¯æ•°æ®
  - `å¤§è„‘ä¸­åŠ¨è„‰ç‹­çª„ä¸é—­å¡è‡´è„‘æ¢—æ­»çš„å½±åƒç‰¹ç‚¹åŠå‘ç—…æœºåˆ¶çš„ç ”ç©¶.pdf` - ä¸­æ–‡åŒ»å­¦è®ºæ–‡

- **ğŸ“ results/** - å®éªŒç»“æœè¾“å‡ºç›®å½•
  - `analysis/` - åˆ†æç»“æœå­ç›®å½•
  - å„ç§JSONã€CSVã€PNGæ ¼å¼çš„å®éªŒç»“æœæ–‡ä»¶

- **ğŸ“ checkpoints/** - æ£€æŸ¥ç‚¹æ–‡ä»¶å­˜å‚¨ç›®å½•

- **ğŸ“ requirements/** - ä¾èµ–æ–‡ä»¶ç›®å½•

### é…ç½®ä¸æ¨¡æ¿æ–‡ä»¶
- **chunk_metadata_schema.json** - åˆ†å—å…ƒæ•°æ®æ¨¡å¼
- **batch_chunk_metadata_templates.json** - æ‰¹é‡åˆ†å—å…ƒæ•°æ®æ¨¡æ¿
- **pyramid_index_example.json** - é‡‘å­—å¡”ç´¢å¼•ç¤ºä¾‹
- **qa_pairs.json** - é—®ç­”å¯¹æ•°æ®
- **corpus.txt** - è¯­æ–™åº“æ–‡ä»¶

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒå‡†å¤‡

1. **å®‰è£…åŸºç¡€ä¾èµ–**ï¼š
```bash
pip install -r requirements.txt
```

2. **å®‰è£…å¯é€‰ä¾èµ–**ï¼ˆæ ¹æ®éœ€è¦ï¼‰ï¼š
```bash
# ç”¨äºPDFå¤„ç†
pip install pymupdf

# ç”¨äºé«˜è´¨é‡åˆ†è¯å’ŒNER
pip install spacy
python -m spacy download zh_core_web_sm

# ç”¨äºç²¾ç¡®tokenè®¡æ•°
pip install tiktoken

# ç”¨äºå‘é‡åŒ–å’Œèšç±»
pip install scikit-learn sentence-transformers
```

### åŸºç¡€ä½¿ç”¨ç¤ºä¾‹

#### 1. è¿è¡ŒåŸºç¡€åˆ†å—å®éªŒ
```bash
# åˆ†å—ç²’åº¦å®éªŒ
python 01-u_curve_chunksize_f1_latency_experiment.py

# é‡å ç‡åˆ†æ
python 02_overlap_coverage_vs_index_scale_analysis.py
```

#### 2. ç”ŸæˆéªŒè¯æ•°æ®é›†
```bash
# ç”Ÿæˆå¤šåœºæ™¯éªŒè¯é›†
python 03-min_evalset_builder_multiscenario.py
```

#### 3. ä½¿ç”¨ç‰¹å®šåˆ†å—å™¨
```bash
# ä½¿ç”¨Tokenå›ºå®šé‡å åˆ†å—å™¨
python 07-_token_fixed_overlap_chunker.py

# ä½¿ç”¨å¯¹è¯è½®æ¬¡æ£€æµ‹å™¨
python 11-dialog_turn_detector.py
```

#### 4. è¿è¡Œé«˜çº§ç­–ç•¥
```bash
# æ··åˆåˆ†å—ç­–ç•¥ç¼–æ’
python 22-hybrid_chunking_strategy_orchestrator.py

# æµ·é‡æ–‡æ¡£å¤„ç†æ¨¡æ‹Ÿ
python 26-massive_pipeline_simulator_checkpointing.py
```

## ğŸ“Š æ ¸å¿ƒåŠŸèƒ½è¯´æ˜

### å®éªŒç±»è„šæœ¬
è¿™äº›è„šæœ¬ä¸»è¦ç”¨äºéªŒè¯åˆ†å—ç­–ç•¥çš„æ•ˆæœå’Œæ€§èƒ½ï¼š

- **æ€§èƒ½è¯„ä¼°**ï¼šF1åˆ†æ•°ã€nDCGã€è¦†ç›–ç‡ã€å»¶è¿Ÿç­‰æŒ‡æ ‡
- **å‚æ•°ä¼˜åŒ–**ï¼šchunk_sizeã€overlapã€top-kç­‰å‚æ•°çš„æœ€ä¼˜é…ç½®
- **å¯¹æ¯”åˆ†æ**ï¼šä¸åŒç­–ç•¥åœ¨å„ç§åœºæ™¯ä¸‹çš„è¡¨ç°å¯¹æ¯”

### åˆ†å—å™¨å®ç°
æä¾›äº†å¤šç§åˆ†å—ç®—æ³•çš„å®Œæ•´å®ç°ï¼š

- **åŸºç¡€åˆ†å—**ï¼šå›ºå®šå¤§å°ã€é‡å çª—å£
- **ç»“æ„åŒ–åˆ†å—**ï¼šåŸºäºæ®µè½ã€æ ‡é¢˜ã€å¯¹è¯è½®æ¬¡
- **è¯­ä¹‰åˆ†å—**ï¼šåŸºäºä¸»é¢˜èšç±»ã€å®ä½“å¯†åº¦ã€ç›¸ä¼¼åº¦
- **æ··åˆç­–ç•¥**ï¼šå¤šç§ä¿¡å·èåˆçš„æ™ºèƒ½åˆ†å—

### è¯„ä¼°ä¸ä¼˜åŒ–å·¥å…·
- **å…ƒæ•°æ®ç”Ÿæˆ**ï¼šæ ‡å‡†åŒ–çš„åˆ†å—å…ƒæ•°æ®æ¨¡æ¿
- **æ€§èƒ½ç›‘æ§**ï¼šèµ„æºä½¿ç”¨æƒ…å†µå’Œç³»ç»Ÿæ€§èƒ½ç›‘æ§
- **è´¨é‡è¯„ä¼°**ï¼šè¦†ç›–ç‡ã€å†—ä½™ç‡ã€ä¿¡æ¯ä¿ç•™åº¦è¯„ä¼°

## ğŸ”§ è°ƒç”¨è¯´æ˜

### é€šç”¨è°ƒç”¨æ¨¡å¼

å¤§å¤šæ•°è„šæœ¬éƒ½éµå¾ªä»¥ä¸‹è°ƒç”¨æ¨¡å¼ï¼š

```python
# 1. å¯¼å…¥æ¨¡å—
from script_name import MainClass

# 2. åˆ›å»ºå®ä¾‹
processor = MainClass(config_params)

# 3. å¤„ç†æ–‡æœ¬
results = processor.process(text_input)

# 4. ä¿å­˜ç»“æœ
processor.save_results(results, output_path)
```

### é…ç½®å‚æ•°è¯´æ˜

å¸¸è§çš„é…ç½®å‚æ•°åŒ…æ‹¬ï¼š
- `chunk_size`: åˆ†å—å¤§å°ï¼ˆå­—ç¬¦æ•°æˆ–tokenæ•°ï¼‰
- `overlap`: é‡å å¤§å°
- `output_dir`: è¾“å‡ºç›®å½•
- `corpus_file`: è¯­æ–™æ–‡ä»¶è·¯å¾„
- `qa_file`: é—®ç­”å¯¹æ–‡ä»¶è·¯å¾„

### è¾“å‡ºæ ¼å¼

å¤§å¤šæ•°è„šæœ¬è¾“å‡ºä»¥ä¸‹æ ¼å¼çš„ç»“æœï¼š
- **JSONæ ¼å¼**ï¼šç»“æ„åŒ–çš„åˆ†å—ç»“æœå’Œå…ƒæ•°æ®
- **CSVæ ¼å¼**ï¼šè¡¨æ ¼å½¢å¼çš„ç»Ÿè®¡æ•°æ®
- **PNGæ ¼å¼**ï¼šå¯è§†åŒ–å›¾è¡¨

## ğŸ“ˆ å®éªŒç»“æœ

æ‰€æœ‰å®éªŒç»“æœéƒ½ä¿å­˜åœ¨ `results/` ç›®å½•ä¸‹ï¼ŒåŒ…æ‹¬ï¼š

- **åˆ†å—ç»“æœ**ï¼šå„ç§ç­–ç•¥çš„åˆ†å—è¾“å‡º
- **æ€§èƒ½æŒ‡æ ‡**ï¼šF1ã€nDCGã€è¦†ç›–ç‡ç­‰è¯„ä¼°ç»“æœ
- **å¯è§†åŒ–å›¾è¡¨**ï¼šæ€§èƒ½å¯¹æ¯”å›¾ã€åˆ†å¸ƒå›¾ç­‰
- **æ—¥å¿—æ–‡ä»¶**ï¼šè¯¦ç»†çš„æ‰§è¡Œæ—¥å¿—å’Œé”™è¯¯ä¿¡æ¯

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°çš„åˆ†å—ç­–ç•¥

1. åˆ›å»ºæ–°çš„Pythonæ–‡ä»¶ï¼Œéµå¾ªå‘½åè§„èŒƒ
2. å®ç°æ ‡å‡†çš„åˆ†å—æ¥å£
3. æ·»åŠ é…ç½®ç±»å’Œå…ƒæ•°æ®æ”¯æŒ
4. ç¼–å†™æµ‹è¯•ç”¨ä¾‹å’Œæ–‡æ¡£

### æ‰©å±•è¯„ä¼°æŒ‡æ ‡

1. åœ¨ç›¸åº”çš„è¯„ä¼°è„šæœ¬ä¸­æ·»åŠ æ–°æŒ‡æ ‡
2. æ›´æ–°ç»“æœè¾“å‡ºæ ¼å¼
3. æ·»åŠ å¯è§†åŒ–æ”¯æŒ

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **ä¾èµ–ç®¡ç†**ï¼šæŸäº›è„šæœ¬éœ€è¦ç‰¹å®šçš„å¤–éƒ¨åº“ï¼Œè¯·æ ¹æ®é”™è¯¯æç¤ºå®‰è£…
2. **æ•°æ®è·¯å¾„**ï¼šç¡®ä¿æµ‹è¯•æ•°æ®æ–‡ä»¶å­˜åœ¨äºæ­£ç¡®çš„è·¯å¾„
3. **å†…å­˜ä½¿ç”¨**ï¼šå¤„ç†å¤§æ–‡ä»¶æ—¶æ³¨æ„å†…å­˜ä½¿ç”¨æƒ…å†µ
4. **ç¼–ç é—®é¢˜**ï¼šæ‰€æœ‰æ–‡ä»¶éƒ½ä½¿ç”¨UTF-8ç¼–ç 

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤Issueå’ŒPull Requestæ¥æ”¹è¿›è¿™ä¸ªé¡¹ç›®ã€‚åœ¨æäº¤ä»£ç å‰ï¼Œè¯·ç¡®ä¿ï¼š

1. ä»£ç ç¬¦åˆé¡¹ç›®çš„ç¼–ç è§„èŒƒ
2. æ·»åŠ äº†é€‚å½“çš„æ–‡æ¡£å’Œæ³¨é‡Š
3. é€šè¿‡äº†åŸºæœ¬çš„æµ‹è¯•

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ã€‚

---

*æœ€åæ›´æ–°ï¼š2025å¹´1æœˆ*